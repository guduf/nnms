#!/usr/bin/env node
const config = require('./dist/nnms.pack.json')
if (!config) {
    console.error('cannot retrieve packed config')
    process.exit(1)
}
const nnms = require('nnms')
if (typeof nnms.bootstrap !== 'function') {
    console.error('cannot nnms bootstrap')
    process.exit(1)
}
const mods = Object.keys(config.dist).map(key => (
  require(config.dist[key].filepath)[config.dist[key].exportKey]
))
const events = nnms.bootstrap(...mods)
events.subscribe(e => console.log(nnms.Log.fromEvent(e).toJson()))
process.on('SIGINT', () => {
  console.log('\ncaught interrupt signal')
  process.exit(0)
})
